/*!
 * Copyright 2019 EPAM Systems
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

.markdown-editor {
  border: 1px solid $COLOR--gray-80;

  &:hover {
    border-color: $COLOR--gray-47;
  }
  &.focused {
    border-color: $COLOR--topaz;
  }
  &.invalid {
    border-color: $COLOR--failed;
  }
  :global {
    .editor-toolbar {
      opacity: 1;
      border-radius: 0;
      border: none;
      border-bottom: 1px solid $COLOR--gray-80;
      background: $COLOR--white;

      &:before {
        margin-bottom: 5px;
      }
      &:after {
        margin-top: 5px;
      }

      a {
        vertical-align: middle;
        background-repeat: no-repeat;
        background-position: center center;
        background-size: 80% 80%;
        outline: none;
        box-sizing: border-box;
        line-height: 27px;
        color: $COLOR--gray-47 !important;

        &.icon-header-1 {
          background-image: url(./img/heading-1-icon.svg);
        }
        &.icon-header-2 {
          background-image: url(./img/heading-2-icon.svg);
        }
        &.icon-header-3 {
          background-image: url(./img/heading-3-icon.svg);
        }
        &.icon-clean-block {
          background-image: url(./img/clean-block-icon.svg);
        }
        &.icon-bold {
          background-image: url(./img/bold-icon.svg);
        }
        &.icon-italic {
          background-image: url(./img/italic-icon.svg);
        }
        &.icon-strikethrough {
          background-image: url(./img/strikethrough-icon.svg);
        }
        &.icon-unordered-list {
          background-image: url(./img/unordered-list-icon.svg);
        }
        &.icon-ordered-list {
          background-image: url(./img/ordered-list-icon.svg);
        }
        &.icon-image {
          background-image: url(./img/image-icon.svg);
        }
        &.icon-link {
          background-image: url(./img/link-icon.svg);
        }
        &.icon-quote {
          background-image: url(./img/quote-icon.svg);
        }
        &.icon-code {
          background-image: url(./img/code-icon.svg);
        }
        &.icon-preview {
          background-image: url(./img/eye-icon.svg);
        }
      }
      &:hover {
        opacity: 1;
      }
      &.disabled-for-preview a:not(.no-disable) {
        background-color: $COLOR--white;
        vertical-align: middle;
        background-repeat: no-repeat;
        background-position: center center;
        background-size: 80% 80%;
        outline: none;
        box-sizing: border-box;
        line-height: 27px;
      }
      .separator {
        vertical-align: middle;
        border-left: none;
        border-color: $COLOR--dark-gray;
      }
    }
    .CodeMirror {
      height: 70px;
      min-height: 50px;
    }
    .CodeMirror-scroll {
      max-height: 350px;
      min-height: 50px;
    }
    .CodeMirror-wrap {
      border: none;
    }
    .CodeMirror .CodeMirror-code {
      font-family: $FONT-MONOSPACE;
      color: $COLOR--charcoal-grey;
      font-size: 12px;

      .cm-header-1 {
        font-size: 18px;
        line-height: normal;
        padding-top: 10px;
        padding-bottom: 10px;
        margin: 0;
        font-weight: normal;
      }
      .cm-header-2 {
        font-size: 16px;
        line-height: normal;
        padding-top: 10px;
        padding-bottom: 10px;
        margin: 0;
        font-weight: normal;
      }
      .cm-header-3 {
        font-size: 14px;
        line-height: normal;
        padding-top: 10px;
        padding-bottom: 10px;
        margin: 0;
        font-weight: normal;
      }
      .cm-header {
        display: inline-block;
      }
      .cm-comment {
        background-color: $COLOR--light-blue;
      }
    }
  }

  &.mode-dark {
    display: flex;
    flex-direction: column-reverse;
    border: none;

    :global {
      .editor-toolbar {
        border: none;
        padding: 0 10px 0 4px;
        background: transparent;

        &:before {
          background: $COLOR--gray-light;
        }

        a {
          width: 22px;
          height: 22px;
        }

        .separator {
          line-height: 25px;
        }
      }

      .CodeMirror {
        height: auto;
        min-height: 30px;
        background-color: transparent;
        color: $COLOR--darkmode-gray-100;

        &-placeholder {
          font-size: 14px;
        }

        ::-webkit-scrollbar {
          width: 4px;
        }

        ::-webkit-scrollbar-track {
          background: $COLOR--black-1;
        }

        ::-webkit-scrollbar-thumb {
          background-color: $COLOR--dark-gray;
          border-radius: 2px;
        }
      }

      .CodeMirror-selected {
        background-color: $COLOR--dirty-gray;
      }
      .CodeMirror-cursor {
        border-left: 1px solid $COLOR--gray-light;
      }

      .CodeMirror-vscrollbar {
        min-height: 40px;
        overflow: auto;
        height: auto;

        div {
          min-height: 40px;
          height: auto;
          overflow: auto;
        }
      }

      .CodeMirror-scroll {
        max-height: 145px;
        min-height: 30px;
        height: auto;
        overflow: auto !important;
      }

      .CodeMirror-scroll > div:nth-child(2) {
        height: auto !important;
        min-height: 30px;
      }

      .CodeMirror-wrap {
        padding: 0;
      }

      .CodeMirror .CodeMirror-code {
        color: $COLOR--darkmode-gray-50;

        .cm-comment {
          border-radius: 0;
          color: $COLOR--khaki-green;
          background-color: $COLOR--has-permission;
        }
      }

      .editor-preview-active {
        background-color: transparent;
        color: $COLOR--gray-light;
        padding: 0 0 0 4px;
      }
    }

    &.preview {
      :global {
        .CodeMirror-scroll {
          visibility: hidden;
        }
      }
    }
  }
}

@mixin additional-text($color) {
  margin-top: 4px;
  width: 100%;
  height: 100%;
  font-size: 10px;
  box-sizing: border-box;
  text-align: left;
  color: $color;
}

.error {
  @include additional-text($COLOR--failed);
}

.hint {
  @include additional-text($COLOR--gray-47);
}
